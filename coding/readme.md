- 程序 = 数据结构 + 算法 + 设计模式

## 代码质量

1. **可维护性**: 修改老代码 & 添加新代码
   - 能够快速地修改或者添加代码
   - 扩展性和可读性有的时候是相冲突的
   - 如何做: 可读 & 简洁 & 扩展
2. **可读性**: 别人阅读不会有太多疑问
   - 与性能维护相悖
   - 命名 + 注释 + 功能{函数} + 调用 + 编码规范 + 设计模块 + 模块划分 + 封装多态继承抽象{耦合}
3. **`可扩展性`**: 扩展点
   - [OCP]不修改或少修改, 新加实现
   - 功能扩展点
   - 接口 & 抽象多态继承 & 耦合 & 分层 & 模块
4. 灵活性
   - 添加新功能有扩展点 & 修改时不耦合
   - 实现功能有复用沉淀
   - 接口抽象满足各种场景
5. 简洁性: 代码简洁 & 逻辑清晰
   - _思从深而行从简_
6. **可复用性**
   - 继承 & 多态
   - 职责单一
   - 解耦内聚 & 模块
   - 设计[如适配器模式等]
7. 日志问题
8. 可测试性
   - 写单元测试容易
   - 单元测试不能依赖于环境: h2 内存数据库

## 代码质量细节

1. 目录模块划分是否清晰, 代码结构是否满足 OOP & "高内聚、松耦合"
2. 遵循设计原则和思想: SOLID、DRY、KISS、YAGNI、LOD
3. 设计模式使用得当
4. 代码评判

   ![avatar](/static/image/pattern/design-guideline.png)

## 重构

- 重构: **意识** + 最小原型 + 两顶帽子{不添加新功能重构为可扩展模式, 再次基础上扩展}

1. 分类
   - 大规模: 模块/分层/交互/沉淀/抽象[设计原则]
   - 小规模: 针对类[方法/命名/行数/职责/重复/细节/复用][编码规范]
2. 一般性步骤
   - 提高代码的可读性: oop & principle
   - 提高代码的可测试性: 非 static
   - 编写完善的单元[类/函数]测试: 单元测试用例如何写, 关键看你如何定义函数
   - 所有重构完成之后添加注释
3. anti-patterns
   - 代码中有未决行为逻辑
   - 滥用可变的全局变量
   - 滥用静态方法
   - 复杂继承
   - 高度耦合
4. 函数出错应该返回

   - ~~返回错误码~~: c 这种语言再用, 不好
   - 异常对象: 是否往上抛要看上层是否关心这个异常
     1. 直接吞掉 + log
     2. re-throw
     3. 包装成新的异常 re-throw
   - NULL 值
     1. 空指针异常
     2. 与业务耦合: 个人看法还是查不到返回 NULL 或者 EMPTY, 而不是 Throw 异常
   - 空对象: **空对象设计模式**

---

## reference

1. https://github.com/Alice52/programming/issues/17
