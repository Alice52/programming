[toc]

## 重构

- 重构: **意识** + 最小原型 + 两顶帽子{不添加新功能重构为可扩展模式, 再次基础上扩展}

1. 分类
   - 大规模: 模块/分层/交互/沉淀/抽象[设计原则]
   - 小规模: 针对类[方法/命名/行数/职责/重复/细节/复用][编码规范]
2. 一般性步骤
   - 提高代码的可读性: oop & principle
   - 提高代码的可测试性: 非 static
   - 编写完善的单元[类/函数]测试: 单元测试用例如何写, 关键看你如何定义函数
   - 所有重构完成之后添加注释
3. anti-patterns
   - 代码中有未决行为逻辑
   - 滥用可变的全局变量
   - 滥用静态方法
   - 复杂继承
   - 高度耦合
4. 函数出错应该返回

   - ~~返回错误码~~: c 这种语言再用, 不好
   - 异常对象: 是否往上抛要看上层是否关心这个异常
     1. 直接吞掉 + log
     2. re-throw
     3. 包装成新的异常 re-throw
   - NULL 值
     1. 空指针异常
     2. 与业务耦合: 个人看法还是查不到返回 NULL 或者 EMPTY, 而不是 Throw 异常
   - 空对象: **空对象设计模式**
