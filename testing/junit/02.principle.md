## 单元测试原则

1. AIR 原则

   - A-Automatic(自动的): 非交互式的 + 不需要人工检查(非日志)
   - I-Independent(独立的): 单测间不能调用 + 不依赖外部资源
   - R-Repeatable(可重复的): 可重复执行

2. FIRST 原则

   - F-Fast(快速的): 大项目的单测也要几分钟内运行完毕
   - I-Independent(独立的)
   - R-Repeatable(可重复的)
   - S-SelfValidating(自我验证的): 不需要人工检查
   - T-Timely(及时的): 单测要继续及时维护

3. ASCII 原则

   - A-Automatic(自动的)
   - S-SelfValidating(自我验证的)
   - C-Consistent(一致的): 单测的参数和结果是确定且一致的
   - I-Independent(独立的)
   - I-Isolated(隔离的): 不依赖外部资源

## 单元测试质量

1. 可读性
2. 可维护性: 统一的范式结构
3. 可信赖: 满足上面的标准
4. 快速执行

## 有效的单元测试

1. 使用测试框架
2. 统一的编码约定
3. 使用测试替身: (隔离代码+加速执行) Dummy + Stub + Spy + Mock
4. 一个测试应当只检查一件事
5. 避免冗余测试
6. _一个测试只有一个模拟对象_
7. 避免条件逻辑
8. 单测需要确定性
9. 测试快速执行
10. 避免过度指定
11. 不要写永不失败的测试，不要写没有校验的测试
12. 测试不要名不副实
13. 测试私有或者受保护的方法: `@visibleForTesting`
14. 避免强制的测试顺序
15. 清理测试环境
16. 统一的单测命名、变量命名
17. 使用有意义的断言
18. 把单元测试视为 "一等公民"
19. 加速执行速度

## 可测试的设计

1. 避免复杂的私有方法: `@visibleForTesting`
2. 避免 final 方法
3. 避免 static 方法
4. 使用 new 要当心
5. **避免构造函数中包含逻辑**
6. 避免单例
7. **组合优于继承**
8. 避免服务查找
9. 基于接口的设计
